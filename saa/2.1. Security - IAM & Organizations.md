  - *Owner* usually means the e-mail owner of the registered account.

## IAM

- Identity Federation 
  - Federating Users of Mobile/Web app using **Cognito**
    - Using Amazon Cognito will create identities(with the help of Mobile SDK) for users and sync across devices.
  - Federating Users with **OpenID Connect** or public identity service provider
    - Using third-party services like Facebook, Google or any identity providers(IdP) compatible with OIDC can federate users. But Amazon recommends using Cognito.
  - Federating users with **SAML 2.0**
    - If companies managing users with identity store like Microsoft Active Directory and Active Directory Federation Service can federate users with single-sign on (SSO) to aws management console. Company can create trust between organization as an identity provider (IdP) and AWS as the service provider if it is compatible with SAML 2.0
  - Federating users by creating a **custom identity brokers**
    - If identity store is not compatible with SAML 2.0 then custom identity broker application can be built.
- Multifactor Authentication
  - 💡 If your MFA device is lost/damaged/notworking:
    - You can sign in using alternative methods of authentication.
      
- **IAM Certificate store**: Legacy way to upload certificates, use Certification Manager instead.
- **IAM Query API** to make direct calls to the IAM web service.

### IAM Entities

- ![IAM entities](./img/iam/iam-entities.png)
- **Principal** is an entity in AWS that can perform actions and access resources.
  - **IAM Users**
    - **Programmatic Access: ID + secret key**
      - Assigned an Access Key ID and Secret Access Key when first created.
      - Secrets are only shown once after created, then needs to be regenerated to reveal/download again.
      - ❗ IDs are permanent you need to manually rotate (make active/disable, delete or create new)
    - **Console Access: Password**
      - 💡 Ensure no one share same users by creating different users per person.
      - By default, newly created IAM users has no permissions.
  - **IAM Roles**
    - 💡 Use cases:
        - 💡 However for unique access of one you can delegate a role through:
          - In account add *trust policy* that specifies which trusted account members are allowed to assume the role.
          - The *trust policy* specifies which trusted account members (*principal*s) are allowed to assume the role.
    - You can only assume one role a time
- **IAM Groups**
  - A group is not an identity and cannot be identified as a principal in an IAM policy,

- **IAM Policies**
  - **Resource-based**: To supported AWS resources, who can access them.
  - **Identity-based**: Assigned to roles, users, groups, who they can access.
  - Overlap => Deny overrides allow.
  
#### IAM Authentication to Services

- User / role (IAM) credentials must be sent in header
  - It's called Sig v4 **AWS Signature Version 4 Signing Process**
  - You sign all requests with signed using an access key (derivation of access key ID + secret access key) in header
- All requests to AWS API's are signed automatically by SDK/CLI.


## AWS Organizations
  
- Consolidate multiple AWS accounts into an organization that you create and centrally manage
  - Enforce (SCP) policies centrally on root or OU's.
- Allows **Consolidated billing**: Multiple standalone accounts are combined and may reduce your overall bill
  - They can still be tracked individually and the cost data can be downloaded in a separate file.

